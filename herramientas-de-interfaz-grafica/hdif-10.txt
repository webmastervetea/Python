# Soporte: https://www.linkedin.com/in/oscarlizarragag/

# Este script crea una aplicaci贸n de escritorio que permite al usuario seleccionar una carpeta,

# \# y luego renombrar archivos masivamente a帽adiendo un prefijo o sufijo.

# \# No se requiere la instalaci贸n de librer铆as externas.

```python
import tkinter as tk
from tkinter import filedialog, messagebox
import os

class RenombradorArchivosApp:
    """
    Clase que gestiona la interfaz gr谩fica y la l贸gica de renombrado masivo de archivos.
    """
    def __init__(self, master):
        # 1. Configuraci贸n de la Ventana Principal
        self.master = master
        master.title("Renombrador Masivo de Archivos")
        master.geometry("500x350")
        master.config(padx=10, pady=10)

        # 2. Variables de Control
        self.ruta_carpeta = tk.StringVar(value="Seleccione una carpeta...")
        self.prefijo = tk.StringVar(value="")
        self.sufijo = tk.StringVar(value="")
        self.contador_archivos = tk.IntVar(value=0) # Contador de archivos encontrados

        # 3. Construcci贸n de la Interfaz
        self.crear_widgets()

    def crear_widgets(self):
        """
        Crea y coloca todos los widgets de la interfaz.
        """
        
        # --- Frame de Selecci贸n de Carpeta ---
        frame_carpeta = tk.LabelFrame(self.master, text="Ruta de la Carpeta", padx=10, pady=5)
        frame_carpeta.pack(fill="x", pady=5)

        tk.Entry(frame_carpeta, 
                 textvariable=self.ruta_carpeta, 
                 state='readonly', 
                 width=50).pack(side=tk.LEFT, fill="x", expand=True, padx=(0, 10))

        tk.Button(frame_carpeta, 
                  text="Seleccionar", 
                  command=self.seleccionar_carpeta).pack(side=tk.RIGHT)

        # --- Frame de Opciones de Renombrado ---
        frame_opciones = tk.LabelFrame(self.master, text="Opciones de Renombrado", padx=10, pady=10)
        frame_opciones.pack(fill="x", pady=10)
        
        # Prefijo
        tk.Label(frame_opciones, text="A帽adir Prefijo:").grid(row=0, column=0, sticky="w", pady=5)
        tk.Entry(frame_opciones, textvariable=self.prefijo, width=30).grid(row=0, column=1, sticky="ew", padx=5)

        # Sufijo
        tk.Label(frame_opciones, text="A帽adir Sufijo (antes de la extensi贸n):").grid(row=1, column=0, sticky="w", pady=5)
        tk.Entry(frame_opciones, textvariable=self.sufijo, width=30).grid(row=1, column=1, sticky="ew", padx=5)

        # --- Frame de Estado y Bot贸n de Ejecuci贸n ---
        frame_ejecutar = tk.Frame(self.master, padx=10, pady=5)
        frame_ejecutar.pack(fill="x", pady=10)
        
        # Contador de archivos
        tk.Label(frame_ejecutar, 
                 textvariable=self.contador_archivos, 
                 font=('Arial', 10),
                 fg='blue').pack(side=tk.LEFT)
        
        tk.Label(frame_ejecutar, 
                 text=" archivos encontrados.",
                 font=('Arial', 10),
                 fg='blue').pack(side=tk.LEFT)

        # Bot贸n de Ejecuci贸n
        tk.Button(frame_ejecutar, 
                  text="RENOMBRAR ARCHIVOS", 
                  command=self.renombrar_archivos,
                  bg='#F44336', fg='white', 
                  font=('Arial', 12, 'bold')).pack(side=tk.RIGHT)


    def seleccionar_carpeta(self):
        """
        Abre el di谩logo de selecci贸n de carpeta y actualiza la ruta.
        Tambi茅n cuenta los archivos dentro de la carpeta.
        """
        # # Abre el di谩logo para seleccionar un directorio
        ruta = filedialog.askdirectory()
        if ruta:
            self.ruta_carpeta.set(ruta)
            self.contar_archivos_en_carpeta(ruta)

    def contar_archivos_en_carpeta(self, ruta):
        """
        Cuenta el n煤mero de archivos (no directorios) en la carpeta dada.
        """
        try:
            archivos = [f for f in os.listdir(ruta) if os.path.isfile(os.path.join(ruta, f))]
            self.contador_archivos.set(len(archivos))
        except Exception:
            # # En caso de error de permiso o ruta, se establece a 0
            self.contador_archivos.set(0)

    def renombrar_archivos(self):
        """
        Ejecuta la l贸gica de renombrado masivo.
        """
        ruta = self.ruta_carpeta.get()
        prefijo = self.prefijo.get().strip()
        sufijo = self.sufijo.get().strip()

        # 1. Validaci贸n inicial
        if not os.path.isdir(ruta):
            messagebox.showerror("Error", "Ruta de carpeta no v谩lida o no seleccionada.")
            return

        if not prefijo and not sufijo:
            messagebox.showerror("Error", "Debe ingresar un Prefijo o un Sufijo para renombrar.")
            return

        if self.contador_archivos.get() == 0:
            messagebox.showwarning("Advertencia", "No se encontraron archivos para renombrar en la carpeta seleccionada.")
            return

        # 2. Confirmaci贸n del usuario (paso cr铆tico)
        respuesta = messagebox.askyesno(
            "Confirmar Renombrado",
            f"驴Est谩 seguro de que desea renombrar {self.contador_archivos.get()} archivos en:\n{ruta}?"
        )

        if not respuesta:
            return

        # 3. L贸gica de Renombrado
        archivos_renombrados = 0
        errores = []

        try:
            # # Iterar sobre el contenido de la carpeta
            for nombre_antiguo in os.listdir(ruta):
                ruta_antigua = os.path.join(ruta, nombre_antiguo)
                
                # # Asegurarse de que solo se procesen archivos, no directorios
                if os.path.isfile(ruta_antigua):
                    # # Separar el nombre base del archivo y su extensi贸n
                    nombre_base, extension = os.path.splitext(nombre_antiguo)
                    
                    # # Construir el nuevo nombre
                    # # Formato: [PREFIJO] + [NOMBRE_BASE] + [SUFIJO] + [EXTENSION]
                    nombre_nuevo = f"{prefijo}{nombre_base}{sufijo}{extension}"
                    
                    # # Construir la nueva ruta completa
                    ruta_nueva = os.path.join(ruta, nombre_nuevo)

                    # # Renombrar el archivo (funci贸n de Python OS)
                    os.rename(ruta_antigua, ruta_nueva)
                    archivos_renombrados += 1

        except Exception as e:
            errores.append(f"Fallo al renombrar {nombre_antiguo}: {e}")
        
        # 4. Mostrar Resultados
        if archivos_renombrados > 0:
            mensaje = f"隆Operaci贸n completada!\nSe renombraron {archivos_renombrados} archivos con 茅xito."
            messagebox.showinfo("xito", mensaje)
        
        if errores:
            messagebox.showwarning("Errores", f"Ocurrieron {len(errores)} errores:\n{errores[0]}...") # Mostrar solo el primer error
            
        # # Actualizar el contador despu茅s del renombrado
        self.contar_archivos_en_carpeta(ruta)


# --- Bloque Principal de Ejecuci贸n ---

def main():
    root = tk.Tk()
    app = RenombradorArchivosApp(root)
    print("# Interfaz de Renombrador de Archivos iniciada.")
    print("# Por favor, selecciona una carpeta y define las opciones de prefijo/sufijo.")
    root.mainloop()

if __name__ == "__main__":
    main()
```

##  Instrucciones para Usar el Programa

1.  **Guarda el c贸digo:** Guarda el c贸digo Python anterior en un archivo, por ejemplo, `renombrador_gui.py`.
2.  **Ejecuta el script:** Abre tu terminal y ejecuta:
    ```bash
    python renombrador_gui.py
    ```
3.  **Usa la aplicaci贸n:**
      * **Selecciona la Carpeta:** Haz clic en **"Seleccionar"** y elige la carpeta que contiene los archivos que quieres renombrar. El contador de archivos se actualizar谩.
      * **Define Opciones:** Escribe el texto que deseas **a帽adir al principio** (Prefijo) y/o el texto que deseas **a帽adir al final** (Sufijo, justo antes de la extensi贸n).
      * **Renombra:** Haz clic en el bot贸n rojo **"RENOMBRAR ARCHIVOS"**. El programa te pedir谩 una confirmaci贸n antes de realizar los cambios.

# 隆Esta aplicaci贸n te proporciona una forma segura e interactiva de realizar renombrados masivos\!


