# Soporte: https://www.linkedin.com/in/oscarlizarragag/


# Este script crea una aplicaci√≥n de escritorio simple para escribir y guardar texto en archivos.

# \# No requiere la instalaci√≥n de librer√≠as externas.

```python
import tkinter as tk
from tkinter import filedialog, messagebox

class CuadernoDeNotasApp:
    """
    Clase principal que gestiona la interfaz gr√°fica y la funcionalidad del cuaderno de notas.
    """
    def __init__(self, master):
        # 1. Configuraci√≥n de la ventana principal
        self.master = master
        master.title("Cuaderno de Notas Minimalista")
        
        # 2. Creaci√≥n del Text Widget (√Årea de Edici√≥n)
        # # El Text widget es el √°rea donde el usuario escribe el contenido.
        self.area_texto = tk.Text(master, 
                                 wrap='word',       # Asegura que el texto se ajuste a la ventana
                                 font=('Arial', 12), 
                                 padx=10, 
                                 pady=10)
        
        # # Usamos 'pack' para colocar el widget, haci√©ndolo expandible (fill=BOTH, expand=True)
        self.area_texto.pack(pady=5, padx=5, fill=tk.BOTH, expand=True)
        
        # 3. Creaci√≥n del Men√∫
        self.crear_menu()
        
        # 4. Inicializar el archivo actual (usado para saber si es un archivo nuevo o existente)
        self.archivo_actual = None
        self.texto_sin_guardar = False # Bandera para verificar si hay cambios

        # # Enlazar un evento para detectar cambios en el texto
        # # # Esto permite saber si el usuario ha modificado el contenido desde el √∫ltimo guardado.
        self.area_texto.bind("<<Modified>>", self.marcar_modificado)


    def crear_menu(self):
        """
        Crea la barra de men√∫ con las opciones Archivo (Nuevo, Abrir, Guardar, Guardar como, Salir).
        """
        menu_bar = tk.Menu(self.master)
        
        # # Men√∫ Archivo
        menu_archivo = tk.Menu(menu_bar, tearoff=0)
        
        # # Opciones del men√∫ Archivo, enlazadas a sus respectivas funciones
        menu_archivo.add_command(label="Nuevo", command=self.nuevo_archivo)
        menu_archivo.add_command(label="Abrir...", command=self.abrir_archivo)
        menu_archivo.add_separator()
        menu_archivo.add_command(label="Guardar", command=self.guardar_archivo)
        menu_archivo.add_command(label="Guardar como...", command=self.guardar_archivo_como)
        menu_archivo.add_separator()
        menu_archivo.add_command(label="Salir", command=self.salir)
        
        # # A√±adir el men√∫ 'Archivo' a la barra de men√∫ principal
        menu_bar.add_cascade(label="Archivo", menu=menu_archivo)
        
        # # Configurar la barra de men√∫ en la ventana principal
        self.master.config(menu=menu_bar)

    def marcar_modificado(self, event=None):
        """
        Marca la bandera de texto modificado si hay un cambio en el widget Text.
        """
        # # Solo marcamos como modificado si no lo estaba ya.
        if not self.texto_sin_guardar:
            self.texto_sin_guardar = True
            self.actualizar_titulo()
            
        # # Resetear la bandera <<Modified>> del widget para detectar el siguiente cambio
        self.area_texto.edit_modified(False)

    def actualizar_titulo(self):
        """
        Actualiza el t√≠tulo de la ventana para reflejar el estado del archivo.
        """
        nombre = self.archivo_actual if self.archivo_actual else "Sin t√≠tulo"
        # # A√±ade un asterisco (*) si hay cambios sin guardar
        titulo_estado = "*" if self.texto_sin_guardar else ""
        self.master.title(f"{titulo_estado}{nombre} - Cuaderno de Notas Minimalista")

    def comprobar_cambios(self):
        """
        Verifica si hay cambios sin guardar y le pide confirmaci√≥n al usuario.
        :return: True si el usuario quiere continuar (o no hay cambios), False si cancela.
        """
        if self.texto_sin_guardar:
            # # Muestra un cuadro de di√°logo de advertencia
            respuesta = messagebox.askyesnocancel(
                "Advertencia",
                "El documento ha sido modificado. ¬øDesea guardar los cambios antes de continuar?"
            )
            if respuesta is None: # El usuario hizo clic en Cancelar
                return False
            elif respuesta is True: # El usuario hizo clic en S√≠ (Guardar)
                return self.guardar_archivo() # Retorna el √©xito o fracaso de guardar
            # # Si la respuesta es False (No guardar), simplemente contin√∫a (retorna True)
        return True

    def nuevo_archivo(self):
        """
        Inicia un nuevo archivo de notas despu√©s de comprobar si hay cambios.
        """
        if self.comprobar_cambios():
            self.area_texto.delete(1.0, tk.END) # Borra todo el contenido (desde la l√≠nea 1, car√°cter 0 hasta el final)
            self.archivo_actual = None
            self.texto_sin_guardar = False
            self.actualizar_titulo()

    def abrir_archivo(self):
        """
        Abre un archivo de texto existente despu√©s de comprobar si hay cambios.
        """
        if not self.comprobar_cambios():
            return
            
        # # Abrir el di√°logo para seleccionar archivos
        ruta_archivo = filedialog.askopenfilename(
            defaultextension=".txt",
            filetypes=[("Archivos de Texto", "*.txt"), ("Todos los archivos", "*.*")]
        )
        
        if ruta_archivo:
            try:
                with open(ruta_archivo, "r", encoding="utf-8") as archivo:
                    contenido = archivo.read()
                
                self.area_texto.delete(1.0, tk.END) # Limpiar el √°rea de texto
                self.area_texto.insert(tk.END, contenido) # Insertar el nuevo contenido
                
                self.archivo_actual = ruta_archivo
                self.texto_sin_guardar = False
                self.actualizar_titulo()
                
            except Exception as e:
                messagebox.showerror("Error al abrir", f"No se pudo abrir el archivo: {e}")

    def guardar_archivo(self):
        """
        Guarda el archivo actual. Si no hay archivo actual, llama a `guardar_archivo_como`.
        :return: True si se guard√≥ con √©xito, False en caso contrario.
        """
        if self.archivo_actual:
            return self._guardar_contenido(self.archivo_actual)
        else:
            return self.guardar_archivo_como()

    def guardar_archivo_como(self):
        """
        Abre el di√°logo 'Guardar como' para que el usuario elija la ruta y nombre.
        :return: True si se guard√≥ con √©xito, False en caso contrario.
        """
        # # Abrir el di√°logo 'Guardar como'
        ruta_archivo = filedialog.asksaveasfilename(
            defaultextension=".txt",
            filetypes=[("Archivos de Texto", "*.txt"), ("Todos los archivos", "*.*")]
        )
        
        if ruta_archivo:
            self.archivo_actual = ruta_archivo
            return self._guardar_contenido(ruta_archivo)
        
        return False # No se guard√≥ si el usuario cancel√≥ el di√°logo

    def _guardar_contenido(self, ruta):
        """
        Funci√≥n auxiliar para escribir el contenido del Text widget al archivo.
        """
        try:
            # # Obtener todo el contenido del widget (desde 1.0 hasta END)
            contenido = self.area_texto.get(1.0, tk.END)
            
            with open(ruta, "w", encoding="utf-8") as archivo:
                archivo.write(contenido)
                
            self.texto_sin_guardar = False
            self.actualizar_titulo()
            messagebox.showinfo("Guardado", f"Archivo guardado con √©xito en:\n{ruta}")
            return True
            
        except Exception as e:
            messagebox.showerror("Error al guardar", f"No se pudo guardar el archivo: {e}")
            return False

    def salir(self):
        """
        Cierra la aplicaci√≥n despu√©s de comprobar si hay cambios.
        """
        if self.comprobar_cambios():
            self.master.destroy()

# --- Bloque Principal de Ejecuci√≥n ---

# # Se crea la ventana ra√≠z (Root)
root = tk.Tk()

# # Se instancia la aplicaci√≥n del cuaderno de notas
cuaderno = CuadernoDeNotasApp(root)

print("# Cuaderno de Notas Minimalista iniciado.")
print("# Usa el men√∫ 'Archivo' para guardar y abrir documentos.")

# # Se inicia el bucle principal de Tkinter
root.mainloop()
```

## üìù Instrucciones para Usar el Programa

1.  **Guarda el c√≥digo:** Guarda el c√≥digo Python anterior en un archivo, por ejemplo, `cuaderno_notas.py`.
2.  **Ejecuta el script:** Abre tu terminal y ejecuta:
    ```bash
    python cuaderno_notas.py
    ```
3.  **Usa la aplicaci√≥n:**
      * Escribe texto en la ventana.
      * Ve a **Archivo** y selecciona **Guardar** o **Guardar como...** para guardar tu trabajo en un archivo `.txt`.
      * Si intentas **Nuevo** o **Salir** con cambios sin guardar, el programa te pedir√° confirmaci√≥n.

