# Soporte: https://www.linkedin.com/in/oscarlizarragag/

# ¬°Excelente e importante aplicaci√≥n de seguridad\! Aqu√≠ tienes una aplicaci√≥n en Python para un **Verificador de Contrase√±a Comprometida**.

# Utilizaremos el servicio **"Have I Been Pwned" (HIBP)**, espec√≠ficamente su API **"Pwned Passwords"**. Esta API usa la t√©cnica de **k-Anonymity** (anonimato-k) para permitirte verificar una contrase√±a sin enviar la contrase√±a completa, protegiendo as√≠ la privacidad del usuario.

# **¬øC√≥mo funciona el anonimato-k (SHA-1 y HIBP)?**

# 1\. El script toma la contrase√±a del usuario y calcula su hash **SHA-1** (un c√≥digo √∫nico de 40 caracteres).

# 2\. **Solo** env√≠a los **primeros 5 caracteres** del hash a la API de HIBP.

# 3\. La API devuelve **todos los hashes** que comienzan con esos 5 caracteres, junto con el n√∫mero de veces que se han encontrado en filtraciones.

# 4\. El script compara el hash **completo** del usuario con la lista de hashes devueltos localmente.

# 5\. Si hay una coincidencia, la contrase√±a ha sido comprometida.

# **Instrucciones Previas:**

# 1\. **Instalar la librer√≠a:** Usaremos la librer√≠a `requests` para las peticiones HTTP.

# `pip install requests`

# 2\. **Ejecutar el script:** Guarda el c√≥digo a continuaci√≥n como un archivo `.py` y ejec√∫talo.

```python
import hashlib
import requests

# # --- Configuraci√≥n ---
# # Endpoint de la API de Pwned Passwords
API_URL = "https://api.pwnedpasswords.com/range/"
# --------------------

# # Funci√≥n principal para verificar la contrase√±a
def verificar_contrasena_comprometida(contrasena):
    
    # # 1. Calcular el hash SHA-1 de la contrase√±a (en may√∫sculas)
    contrasena_encoded = contrasena.encode('utf-8')
    hash_sha1 = hashlib.sha1(contrasena_encoded).hexdigest().upper()
    
    # # 2. Dividir el hash para la consulta de k-Anonymity
    hash_prefijo = hash_sha1[:5]
    hash_sufijo = hash_sha1[5:]
    
    print(f"\n# Hash SHA-1 generado: {hash_prefijo}{hash_sufijo}")
    print(f"# Consultando API con prefijo: {hash_prefijo}")

    try:
        # # 3. Enviar el prefijo a la API
        response = requests.get(API_URL + hash_prefijo)
        response.raise_for_status() # # Lanza una excepci√≥n si hay un error en el c√≥digo de estado
        
        # # 4. Procesar la respuesta
        # # La respuesta es una lista de sufijos de hash y sus recuentos, separados por ":".
        hashes_comprometidos = response.text.splitlines()
        
        encontrada = False
        veces_filtrada = 0
        
        # # 5. Buscar el sufijo completo del usuario en la lista devuelta
        for linea in hashes_comprometidos:
            sufijo_api, recuento = linea.split(':')
            
            if sufijo_api == hash_sufijo:
                encontrada = True
                veces_filtrada = int(recuento)
                break
        
        # # 6. Mostrar el resultado
        print("\n# ==============================================================")
        if encontrada:
            print(f"# ‚ùå ¬°CONTRASE√ëA COMPROMETIDA ENCONTRADA! üö®")
            print(f"# Esta contrase√±a fue filtrada **{veces_filtrada:,}** veces en bases de datos p√∫blicas.")
            print("# **ACCI√ìN REQUERIDA:** ¬°Cambia esta contrase√±a inmediatamente en todos tus servicios!")
        else:
            print("# ‚úÖ ¬°Contrase√±a NO ENCONTRADA en las filtraciones p√∫blicas! üéâ")
            print("# (Esto no garantiza seguridad, pero indica que no ha sido expuesta p√∫blicamente).")
            
        print("# ==============================================================")
        
    except requests.exceptions.RequestException as e:
        print(f"\n# Ocurri√≥ un error al conectar con la API: {e}")
    except Exception as e:
        print(f"\n# Ocurri√≥ un error inesperado: {e}")


# # Bucle principal de la aplicaci√≥n
if __name__ == "__main__":
    
    print("# Bienvenido al Verificador de Contrase√±as Comprometidas (API HIBP).")
    print("# Tu privacidad est√° protegida: solo se env√≠an los primeros 5 caracteres del hash de tu contrase√±a.")
    
    while True:
        try:
            # # Usamos input() para la entrada y strip() para eliminar espacios
            contrasena_busqueda = input("\n# Ingresa la contrase√±a a verificar (o 'salir'): ").strip()
            
            if contrasena_busqueda.lower() == 'salir':
                print("# ¬°Adi√≥s! Gracias por usar el Verificador de Contrase√±as.")
                break
            
            if contrasena_busqueda:
                verificar_contrasena_comprometida(contrasena_busqueda)
            else:
                print("# Por favor, ingresa una contrase√±a.")

        except EOFError:
            print("\n# ¬°Adi√≥s! Gracias por usar el Verificador de Contrase√±as.")
            break
        except KeyboardInterrupt:
            print("\n# ¬°Adi√≥s! Gracias por usar el Verificador de Contrase√±as.")
            break
```


