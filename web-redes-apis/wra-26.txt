# Soporte: https://www.linkedin.com/in/oscarlizarragag/

# ¬°Claro\! Aqu√≠ tienes la aplicaci√≥n en Python para un **Notificador de Cumplea√±os** que lee un archivo CSV y env√≠a recordatorios por correo electr√≥nico.

# Utilizaremos el m√≥dulo est√°ndar de Python **`csv`** para leer el archivo y los m√≥dulos **`smtplib`** y **`email`** para enviar el correo electr√≥nico.

# **Instrucciones Previas (¬°Muy Importantes\!):**

# 1\. **Crea el Archivo CSV:** Crea un archivo llamado `cumpleanios.csv` en la misma carpeta que tu script con el siguiente formato:

# \`\`\`csv

# nombre,correo,dia,mes

# Ana P√©rez,ana.perez@ejemplo.com,27,11

# Juan G√≥mez,juan.gomez@ejemplo.com,1,12

# \`\`\`

# 2\. **Configura tu Correo Electr√≥nico:** Para que `smtplib` funcione, necesitas configurar una cuenta de correo electr√≥nico.

# \* **Gmail:** Si usas Gmail, **NO** uses tu contrase√±a principal. Debes generar una **Contrase√±a de Aplicaci√≥n** a trav√©s de la configuraci√≥n de seguridad de tu cuenta.

# \* **Aseg√∫rate de reemplazar los marcadores de posici√≥n** con tus datos reales.

# 3\. **Instalar librer√≠as (Solo si no tienes las b√°sicas):**

# `pip install pandas` (opcional, pero ayuda a manejar CSV, aunque aqu√≠ usamos el m√≥dulo `csv` base)

```python
import csv
import smtplib
from email.mime.text import MIMEText
import datetime
import os

# # --- Configuraci√≥n del Archivo y Email (Ajusta esto) ---
ARCHIVO_CUMPLEANIOS = "cumpleanios.csv"
DIAS_DE_ANTICIPACION = 7 # # D√≠as antes para enviar el recordatorio

# # Credenciales y Servidor de Correo (Ejemplo: Gmail)
EMAIL_EMISOR = "tu_correo@gmail.com"
CONTRASENA_APP = "TU_CONTRASE√ëA_DE_APLICACION" # # ¬°Usa una contrase√±a de app, no la principal!
SMTP_SERVER = "smtp.gmail.com"
SMTP_PORT = 587 # # Puerto TLS/STARTTLS
# --------------------

# # Funci√≥n para enviar el correo de recordatorio
def enviar_recordatorio(nombre_contacto, correo_contacto, fecha_cumpleanios):
    
    # # Formatear la fecha
    fecha_formateada = fecha_cumpleanios.strftime("%d de %B")
    
    # # Contenido del correo
    asunto = f"ü•≥ ¬°Recordatorio de Cumplea√±os: {nombre_contacto}! üéÇ"
    cuerpo = f"""
# Hola,

# Este es un recordatorio autom√°tico.
# ¬°El cumplea√±os de {nombre_contacto} (Email: {correo_contacto}) es pronto, el d√≠a **{fecha_formateada}**!

# No olvides enviarle tus mejores deseos.

# Saludos,
# Tu Notificador de Cumplea√±os en Python
"""
    
    # # Crear el objeto MIMEText
    msg = MIMEText(cuerpo)
    msg['Subject'] = asunto
    msg['From'] = EMAIL_EMISOR
    msg['To'] = EMAIL_EMISOR # # Nos lo enviamos a nosotros mismos como recordatorio
    
    # # Establecer conexi√≥n con el servidor SMTP
    try:
        # # Crear la conexi√≥n segura (STARTTLS)
        with smtplib.SMTP(SMTP_SERVER, SMTP_PORT) as server:
            server.starttls() # # Habilitar cifrado
            server.login(EMAIL_EMISOR, CONTRASENA_APP)
            server.sendmail(EMAIL_EMISOR, EMAIL_EMISOR, msg.as_string())
            
        print(f"# ‚úÖ Recordatorio enviado para: **{nombre_contacto}** ({fecha_formateada}).")
        return True
        
    except smtplib.SMTPAuthenticationError:
        print("\n# ‚ùå ERROR DE AUTENTICACI√ìN: Usuario o Contrase√±a de Aplicaci√≥n incorrectos. Revisa tu configuraci√≥n de Gmail.")
        return False
    except Exception as e:
        print(f"\n# ‚ùå ERROR al enviar correo para {nombre_contacto}: {e}")
        return False


# # Funci√≥n principal para leer y verificar los cumplea√±os
def verificar_cumpleanios():
    
    if not os.path.exists(ARCHIVO_CUMPLEANIOS):
        print(f"\n# ¬°Error! El archivo '{ARCHIVO_CUMPLEANIOS}' no se encontr√≥. Aseg√∫rate de crearlo en el directorio correcto.")
        return

    hoy = datetime.date.today()
    fecha_limite = hoy + datetime.timedelta(days=DIAS_DE_ANTICIPACION)
    
    cumpleanios_encontrados = 0
    
    print(f"\n# Fecha de verificaci√≥n: {hoy.strftime('%Y-%m-%d')}")
    print(f"# Buscando cumplea√±os entre hoy y el: {fecha_limite.strftime('%Y-%m-%d')}")
    print("# --------------------------------------------------------------")

    try:
        with open(ARCHIVO_CUMPLEANIOS, mode='r', encoding='utf-8') as archivo:
            # # Usar el lector de diccionario para manejar los encabezados
            lector_csv = csv.DictReader(archivo)
            
            for fila in lector_csv:
                try:
                    nombre = fila['nombre']
                    correo = fila['correo']
                    dia = int(fila['dia'])
                    mes = int(fila['mes'])
                    
                    # # Usar el a√±o actual para la comparaci√≥n
                    fecha_cumpleanios = datetime.date(hoy.year, mes, dia)

                    # # Si el cumplea√±os ya pas√≥ este a√±o, lo verificamos para el pr√≥ximo
                    if fecha_cumpleanios < hoy:
                        fecha_cumpleanios = fecha_cumpleanios.replace(year=hoy.year + 1)
                    
                    # # Verificar si el cumplea√±os est√° dentro del rango de d√≠as de anticipaci√≥n
                    if hoy <= fecha_cumpleanios <= fecha_limite:
                        
                        dias_restantes = (fecha_cumpleanios - hoy).days
                        print(f"# Cumplea√±os de {nombre} encontrado. Faltan **{dias_restantes} d√≠as**.")
                        
                        # # Enviar el recordatorio
                        enviar_recordatorio(nombre, correo, fecha_cumpleanios)
                        cumpleanios_encontrados += 1
                        
                except ValueError:
                    print(f"# ¬°Advertencia! Error al leer la fila (fechas no num√©ricas): {fila}")
                except KeyError as e:
                    print(f"# ¬°Error! Columna '{e}' no encontrada en el CSV. Verifica el formato (nombre,correo,dia,mes).")
                    return # # Detener si el formato es incorrecto

        if cumpleanios_encontrados == 0:
            print("# No se encontraron cumplea√±os pr√≥ximos para notificar.")
            
    except Exception as e:
        print(f"\n# Ocurri√≥ un error inesperado al procesar el archivo: {e}")


# # Bucle principal de la aplicaci√≥n
if __name__ == "__main__":
    
    if EMAIL_EMISOR == "tu_correo@gmail.com" or CONTRASENA_APP == "TU_CONTRASE√ëA_DE_APLICACION":
        print("# --- ADVERTENCIA ---")
        print("# **Debes configurar EMAIL_EMISOR y CONTRASENA_APP** con tus credenciales reales para que el env√≠o funcione.")
        print("# -------------------")
        
    print("# Bienvenido al Notificador de Cumplea√±os.")
    
    # # Llamar a la funci√≥n de verificaci√≥n
    verificar_cumpleanios()

```


