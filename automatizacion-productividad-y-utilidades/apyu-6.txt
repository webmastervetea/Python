# Soporte: https://www.linkedin.com/in/oscarlizarragag/

# Este script requiere que la librer√≠a **pyautogui** est√© instalada.

# \# Puedes instalarla con `pip install pyautogui`.

# \# ADVERTENCIA: Una vez que el script comienza a correr, perder√°s el control

# \# \# del rat√≥n. ¬°Aseg√∫rate de saber c√≥mo detenerlo\!

```python
import pyautogui
import time
import sys
from tkinter import Tk, messagebox

# --- CONFIGURACI√ìN DE SEGURIDAD ---

# # Intervalo de seguridad: Mover el rat√≥n a la esquina superior izquierda detiene el script.
pyautogui.FAILSAFE = True
# # Duraci√≥n de la pausa entre cada comando de pyautogui (hace la automatizaci√≥n m√°s visible)
pyautogui.PAUSE = 0.5 

def automatizar_tarea_ejemplo():
    """
    Ejecuta una secuencia de comandos automatizados de rat√≥n y teclado.
    
    EJEMPLO: Abrir el Bloc de Notas (Windows) o Editor de Texto (Linux/Mac),
             escribir un saludo y guardarlo.
    """
    
    # 1. Esperar un momento para que el usuario mueva el foco a donde debe estar
    print("# ‚è≥ Tienes 5 segundos para mover el rat√≥n y la ventana a la posici√≥n inicial.")
    time.sleep(5)
    print("# üöÄ Iniciando la automatizaci√≥n...")
    
    try:
        # --- PASO 1: Abrir la Aplicaci√≥n (Ejemplo: Bloc de Notas) ---
        
        # # Presionar la tecla de Windows (Win) o Command (Mac) y luego 'r' para abrir "Ejecutar"
        pyautogui.hotkey('win', 'r') 
        # # Esperar un breve momento para que la ventana de Ejecutar aparezca
        time.sleep(1) 
        
        # # Escribir el nombre del programa y presionar Enter
        # # # Windows: 'notepad'
        # # # Linux/Mac (si tienes un lanzador): Puedes usar el nombre de tu editor.
        pyautogui.write('notepad', interval=0.1)
        pyautogui.press('enter')
        time.sleep(1)
        
        # --- PASO 2: Escribir el Contenido ---
        
        # # Escribir la cadena de texto con un intervalo de 0.05 segundos entre letras
        texto = "Hola, esto es una prueba de automatizaci√≥n con PyAutoGUI."
        pyautogui.write(texto, interval=0.05)
        pyautogui.press('enter')
        pyautogui.write(time.ctime(), interval=0.05) # Escribir la fecha y hora actuales
        
        # --- PASO 3: Guardar el Archivo ---
        
        # # Presionar Ctrl + S para abrir el di√°logo de Guardar
        pyautogui.hotkey('ctrl', 's')
        time.sleep(1)
        
        # # Escribir el nombre del archivo (Aseg√∫rate de que la ruta sea accesible)
        # # # Nota: El di√°logo de guardar puede variar. Esto asume que el foco est√° en el campo de nombre.
        pyautogui.write('Reporte_Automatico.txt', interval=0.05)
        pyautogui.press('enter')
        time.sleep(1)
        
        # # (Opcional) Presionar Alt + F4 para cerrar el Bloc de Notas
        pyautogui.hotkey('alt', 'f4')
        
        print("# ‚úÖ Tarea de automatizaci√≥n completada con √©xito.")

    except pyautogui.FailSafeException:
        print("\n# üõë ¬°FUNCI√ìN DE FAIL-SAFE ACTIVADA! El script se detuvo (moviste el rat√≥n a la esquina).")
    except Exception as e:
        print(f"\n# ‚ùå ERROR durante la automatizaci√≥n: {e}")
        messagebox.showerror("Error de Automatizaci√≥n", f"El script fall√≥. Aseg√∫rate de que las aplicaciones est√©n instaladas y las rutas sean correctas. Error: {e}")


# --- Bloque Principal de Ejecuci√≥n ---

def main():
    try:
        # # Inicializar Tkinter solo para mostrar el di√°logo de advertencia
        root = Tk()
        root.withdraw() 
        
        messagebox.showwarning(
            "ADVERTENCIA DE SEGURIDAD",
            "Est√°s a punto de iniciar un script que controlar√° tu rat√≥n y teclado.\n\n"
            "PARA DETENERLO INMEDIATAMENTE: Mueve el cursor del rat√≥n a la esquina superior izquierda de la pantalla."
        )
        
        automatizar_tarea_ejemplo()

    except Exception as e:
        print(f"Error fatal: {e}")
        sys.exit(1)

if __name__ == "__main__":
    main()
```

## üìù Instrucciones y Advertencias Cruciales

1.  **Instala `pyautogui`:** Abre tu terminal y ejecuta:

    ```bash
    pip install pyautogui
    ```

2.  **Advertencia de Seguridad:**

      * **FAIL-SAFE:** Por defecto, si mueves el rat√≥n a la esquina superior izquierda de tu pantalla (coordenadas 0, 0) el script se detendr√° inmediatamente. **Conoce esta funci√≥n.**
      * **Plataforma:** Los comandos (`notepad`, `win+r`, `alt+f4`) son espec√≠ficos de Windows. Si usas **Linux** o **macOS**, deber√°s ajustar los comandos del teclado dentro de la funci√≥n `automatizar_tarea_ejemplo()` para que coincidan con tu sistema (por ejemplo, usar `pyautogui.hotkey('command', 'space')` para abrir Spotlight en Mac).

3.  **Guarda y Ejecuta:** Guarda el c√≥digo en un archivo (`automatizador.py`) y ejec√∫talo:

    ```bash
    python automatizador.py
    ```

4.  **Prep√°rate:** Cuando aparezca el mensaje de espera, mueve tu rat√≥n a la posici√≥n que desees que sea el punto de partida (por ejemplo, la esquina de tu escritorio) y prep√°rate para actuar en caso de emergencia moviendo el rat√≥n a la esquina superior izquierda.

# Este ejemplo demuestra la apertura de una aplicaci√≥n, la escritura de texto y el guardado de un archivo.



