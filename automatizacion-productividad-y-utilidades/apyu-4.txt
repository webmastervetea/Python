# Soporte: https://www.linkedin.com/in/oscarlizarragag/

# Este script utiliza el m√≥dulo **shutil** para la copia recursiva de directorios y

# \# **os** y **datetime** para la gesti√≥n de rutas y marcas de tiempo.

```python
import shutil
import os
from datetime import datetime
import sys
from tkinter import Tk, filedialog, messagebox

# --- CONFIGURACI√ìN ---

# # Rutas que se utilizar√°n para la copia de seguridad.
# # # NOTA: ¬°DEBES REEMPLAZAR ESTAS RUTAS CON LAS TUYAS!
RUTAS_ORIGEN = [
    os.path.expanduser("~/Documentos/Importantes"), # Ejemplo de carpeta en Documentos (funciona en Win/Linux/Mac)
    os.path.expanduser("~/MisImagenes/Vacaciones"),    # Otro ejemplo de ruta a una carpeta de im√°genes
]

# # Ruta donde se guardar√°n las copias de seguridad.
# # # Recomendado: una unidad externa, una carpeta en la nube o un servidor.
# # # Ejemplo: Una carpeta llamada 'Backups' en el escritorio.
RUTA_DESTINO_BASE = os.path.expanduser("~/Desktop/MiBackupSimple")


def ejecutar_copia_seguridad(origenes, destino_base):
    """
    Coordina el proceso de copia de seguridad creando una carpeta con marca de tiempo.

    :param origenes: Lista de rutas de directorios a copiar.
    :param destino_base: Directorio donde se crear√°n las carpetas de backup.
    :return: True si la operaci√≥n fue exitosa.
    """
    
    # 1. Crear la carpeta de destino con marca de tiempo
    # # Generar la marca de tiempo en formato YYYYMMDD_HHMMSS
    marca_tiempo = datetime.now().strftime("%Y%m%d_%H%M%S")
    
    # # Construir la ruta final de la copia de seguridad (e.g., /Destino/Backup_20251127_093000)
    ruta_destino_final = os.path.join(destino_base, f"Backup_{marca_tiempo}")
    
    print(f"# ‚è≥ Iniciando copia de seguridad...")
    print(f"# Destino de la copia: {ruta_destino_final}")
    
    # # Asegurarse de que el directorio base exista
    try:
        os.makedirs(ruta_destino_final, exist_ok=True)
    except Exception as e:
        print(f"# ERROR: No se pudo crear el directorio de destino: {e}")
        messagebox.showerror("Error Cr√≠tico", f"No se pudo crear la carpeta de destino: {ruta_destino_final}")
        return False
    
    copias_exitosas = 0
    
    # 2. Copiar cada directorio de origen
    for ruta_origen in origenes:
        # # Extraer solo el nombre de la carpeta (e.g., "Importantes")
        nombre_carpeta = os.path.basename(ruta_origen.rstrip(os.sep))
        ruta_destino_carpeta = os.path.join(ruta_destino_final, nombre_carpeta)
        
        print(f"# Copiando: '{ruta_origen}' a '{nombre_carpeta}'...")
        
        if not os.path.exists(ruta_origen):
            print(f"# ‚ö†Ô∏è Advertencia: La ruta de origen no existe y se omitir√°: {ruta_origen}")
            continue
            
        try:
            # # shutil.copytree: Copia recursivamente todo el √°rbol de directorios.
            # # # `dirs_exist_ok=True` permite que la copia se realice incluso si el destino existe
            # # # (aunque no deber√≠a existir ya que la marca de tiempo es √∫nica).
            shutil.copytree(ruta_origen, ruta_destino_carpeta, dirs_exist_ok=True)
            copias_exitosas += 1
            print(f"# ‚úÖ Copia exitosa de: {nombre_carpeta}")
            
        except shutil.Error as e:
            print(f"# ‚ùå ERROR al copiar {nombre_carpeta}: {e}")
        except Exception as e:
            print(f"# ‚ùå ERROR inesperado al copiar {nombre_carpeta}: {e}")

    # 3. Mostrar el resultado final
    if copias_exitosas == len(origenes):
        mensaje = f"üéâ Copia de seguridad COMPLETADA con √©xito de {copias_exitosas} rutas."
        print(f"\n{mensaje}")
        return True
    else:
        mensaje = f"‚ùå Copia de seguridad FINALIZADA. {copias_exitosas} de {len(origenes)} rutas copiadas con √©xito."
        print(f"\n{mensaje}")
        return False

# --- Bloque Principal de Ejecuci√≥n (con di√°logo de confirmaci√≥n de ruta) ---

def main():
    # # Inicializar Tkinter para los di√°logos gr√°ficos
    root = Tk()
    root.withdraw() 
    
    print("# --- COPIA DE SEGURIDAD SIMPLE ---")
    
    # 1. Mostrar la configuraci√≥n y pedir confirmaci√≥n
    print("## Configuraci√≥n actual:")
    print(f"# - Or√≠genes: {RUTAS_ORIGEN}")
    print(f"# - Destino Base: {RUTA_DESTINO_BASE}")
    
    respuesta = messagebox.askyesno(
        "Confirmar Copia de Seguridad",
        f"¬øDesea iniciar la copia de seguridad de las {len(RUTAS_ORIGEN)} rutas definidas a:\n{RUTA_DESTINO_BASE}\n\n(Aseg√∫rese de que las rutas de origen sean correctas antes de continuar)"
    )

    if respuesta:
        ejecutar_copia_seguridad(RUTAS_ORIGEN, RUTA_DESTINO_BASE)
    else:
        print("# Operaci√≥n de copia de seguridad cancelada por el usuario.")

if __name__ == "__main__":
    main()
```

## üìù Instrucciones Cruciales para Usar el Programa

1.  **Edita las Rutas:**
      * **Antes de ejecutar**, debes modificar las rutas dentro de la secci√≥n **`RUTAS_ORIGEN`** para apuntar a las carpetas que realmente quieres respaldar.
      * Modifica **`RUTA_DESTINO_BASE`** para que apunte a tu unidad externa o carpeta de backup deseada.
2.  **Guarda el c√≥digo:** Guarda el c√≥digo Python anterior en un archivo, por ejemplo, `backup_simple.py`.
3.  **Ejecuta el script:** Abre tu terminal y ejecuta:
    ```bash
    python backup_simple.py
    ```
4.  **Confirma:** Aparecer√° una ventana de confirmaci√≥n antes de que comience el proceso de copia.

# Cada vez que ejecutes este script, crear√° una **nueva carpeta** dentro de `RUTA_DESTINO_BASE` con la fecha y hora exacta, garantizando que nunca sobrescribas una copia de seguridad anterior.




