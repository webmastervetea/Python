# Soporte: https://www.linkedin.com/in/oscarlizarragag/

# Este script utiliza el mÃ³dulo **os** para interactuar con el sistema de archivos

# \# y Tkinter para la interfaz grÃ¡fica. No requiere librerÃ­as externas.

```python
import os
import sys
import tkinter as tk
from tkinter import filedialog, messagebox

# --- CONFIGURACIÃ“N Y UTILIDADES ---

# # NÃºmero de resultados principales a mostrar
TOP_N = 15

def get_folder_size(start_path):
    """
    Calcula recursivamente el tamaÃ±o total de una carpeta.

    :param start_path: La ruta de la carpeta de inicio.
    :return: El tamaÃ±o total en bytes.
    """
    total_size = 0
    
    # # os.walk genera los nombres de archivo en un Ã¡rbol de directorios
    for dirpath, dirnames, filenames in os.walk(start_path):
        for f in filenames:
            ruta_completa = os.path.join(dirpath, f)
            # # Ignorar enlaces simbÃ³licos para evitar bucles infinitos
            if not os.path.islink(ruta_completa):
                try:
                    # # Sumar el tamaÃ±o de cada archivo
                    total_size += os.path.getsize(ruta_completa)
                except Exception:
                    # # Ignorar archivos a los que no se puede acceder
                    pass
    return total_size

def bytes_to_human_readable(size_bytes):
    """
    Convierte un tamaÃ±o en bytes a un formato legible (KB, MB, GB, etc.).
    """
    if size_bytes == 0:
        return "0 Bytes"
    
    # # Las unidades de medida de disco (base 1024)
    unidades = ("Bytes", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB")
    
    # # Calcular el Ã­ndice de la unidad
    i = 0
    size = size_bytes
    while size >= 1024 and i < len(unidades) - 1:
        size /= 1024
        i += 1
        
    return f"{size:.2f} {unidades[i]}"

def analizar_uso_disco(directorio_raiz):
    """
    Escanea la carpeta raÃ­z y lista las carpetas y archivos mÃ¡s grandes.
    
    :param directorio_raiz: La ruta de la carpeta a escanear.
    """
    if not os.path.isdir(directorio_raiz):
        messagebox.showerror("Error", "Ruta de directorio no vÃ¡lida.")
        return

    print(f"\n# ğŸ” Iniciando anÃ¡lisis de uso de disco en: {directorio_raiz}")
    
    # # Almacenar los resultados: (tamaÃ±o_bytes, ruta)
    elementos = []
    
    # 1. Analizar subcarpetas (Nivel 1)
    try:
        # # Recorrer solo los elementos del directorio raÃ­z
        for nombre in os.listdir(directorio_raiz):
            ruta_completa = os.path.join(directorio_raiz, nombre)
            
            if os.path.islink(ruta_completa):
                continue
                
            if os.path.isdir(ruta_completa):
                # # Si es una carpeta, calcular el tamaÃ±o recursivamente
                size = get_folder_size(ruta_completa)
                elementos.append((size, ruta_completa))
            elif os.path.isfile(ruta_completa):
                # # Si es un archivo, obtener el tamaÃ±o directamente
                size = os.path.getsize(ruta_completa)
                elementos.append((size, ruta_completa))
                
    except Exception as e:
        print(f"# âŒ Error al acceder al directorio: {e}")
        messagebox.showerror("Error de Acceso", f"No se pudo acceder a {directorio_raiz}. Revisa los permisos.")
        return

    # 2. Ordenar los resultados por tamaÃ±o (descendente)
    # # `key=lambda x: x[0]` indica que la ordenaciÃ³n debe basarse en el primer elemento de la tupla (el tamaÃ±o).
    elementos.sort(key=lambda x: x[0], reverse=True)

    # 3. Mostrar los resultados
    print(f"\n# --- TOP {TOP_N} ELEMENTOS POR USO DE DISCO ---")
    
    # # Obtener el tamaÃ±o total del directorio raÃ­z para calcular el porcentaje
    total_root_size = get_folder_size(directorio_raiz)
    
    # # Mostrar la lista
    for i, (size, ruta) in enumerate(elementos[:TOP_N]):
        if size == 0:
            continue
            
        porcentaje = (size / total_root_size) * 100 if total_root_size > 0 else 0
        tipo = "ğŸ“ Carpeta" if os.path.isdir(ruta) else "ğŸ“„ Archivo"
        
        # # Formatear la salida
        tamano_legible = bytes_to_human_readable(size)
        
        print(f"#{i+1:02d}. {tipo:<9} | {tamano_legible:<10} | {porcentaje:5.2f}% | {ruta}")

    print("--------------------------------------------------")
    print(f"# TamaÃ±o Total Analizado: {bytes_to_human_readable(total_root_size)}")
    print("# AnÃ¡lisis finalizado.")


# --- Bloque Principal de EjecuciÃ³n (con GUI para seleccionar carpeta) ---

def main():
    # # Inicializar Tkinter para el diÃ¡logo grÃ¡fico
    root = tk.Tk()
    root.withdraw() 
    
    print("# --- MONITOR DE USO DE DISCO ---")
    
    # # Abrir diÃ¡logo para seleccionar la carpeta a escanear
    directorio_a_escanear = filedialog.askdirectory(title="Seleccione la carpeta raÃ­z a analizar")
    
    if not directorio_a_escanear:
        print("# OperaciÃ³n cancelada por el usuario. Saliendo.")
        sys.exit(0)
        
    analizar_uso_disco(directorio_a_escanear)

if __name__ == "__main__":
    main()
```

## ğŸ“ Instrucciones para Usar el Programa

1.  **Guarda el cÃ³digo:** Guarda el cÃ³digo Python anterior en un archivo, por ejemplo, `monitor_disco.py`.
2.  **Ejecuta el script:** Abre tu terminal y ejecuta:
    ```bash
    python monitor_disco.py
    ```
3.  **Selecciona la Carpeta:** Se abrirÃ¡ una ventana de diÃ¡logo pidiÃ©ndote que elijas la carpeta o unidad que deseas analizar. **Ten en cuenta:** Analizar unidades completas o carpetas muy grandes tomarÃ¡ tiempo, ya que el script debe examinar recursivamente cada archivo.
4.  **Revisa los Resultados:** El script imprimirÃ¡ en la consola la lista de las **15 carpetas o archivos mÃ¡s grandes** que encontrÃ³, mostrando su tamaÃ±o en un formato legible (KB, MB, GB), el porcentaje que representa del total analizado, y la ruta completa.

# La funciÃ³n `get_folder_size` se encarga de calcular el tamaÃ±o total de una carpeta incluyendo todos sus archivos y subcarpetas.




