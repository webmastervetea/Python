# Soporte: https://www.linkedin.com/in/oscarlizarragag/

# Este script requiere que la librer铆a **Pandas** est茅 instalada.

# \# Puedes instalarla con `pip install pandas`.

```python
import pandas as pd
import os

def filtrar_datos_csv(nombre_archivo_entrada, columna_filtro, valor_limite):
    """
    Carga un archivo CSV, filtra los datos de una columna num茅rica 
    por un valor l铆mite y guarda el resultado en un nuevo CSV.

    :param nombre_archivo_entrada: El nombre/ruta del archivo CSV a leer.
    :param columna_filtro: El nombre de la columna num茅rica por la que se filtrar谩.
    :param valor_limite: El valor num茅rico m铆nimo (o m谩ximo) para la condici贸n de filtro.
    :return: True si el proceso fue exitoso, False en caso contrario.
    """
    
    # 1. Manejo de errores para la lectura del CSV
    try:
        # # Cargar el archivo CSV en un DataFrame de Pandas
        # # `sep=','` es el delimitador por defecto, pero se especifica para claridad.
        df = pd.read_csv(nombre_archivo_entrada, sep=',')
        print(f"# Archivo '{nombre_archivo_entrada}' cargado con {len(df)} filas.")
        
    except FileNotFoundError:
        print(f"Error: El archivo de entrada '{nombre_archivo_entrada}' no fue encontrado.")
        return False
    except pd.errors.EmptyDataError:
        print(f"Error: El archivo '{nombre_archivo_entrada}' est谩 vac铆o o solo contiene el encabezado.")
        return False
    except Exception as e:
        print(f"Error al cargar el CSV: {e}")
        return False

    # 2. Verificar la columna de filtro
    if columna_filtro not in df.columns:
        print(f"Error: La columna de filtro '{columna_filtro}' no existe en el archivo CSV.")
        print(f"# Columnas disponibles: {list(df.columns)}")
        return False

    # 3. Aplicar la condici贸n de filtro
    # # Definimos la condici贸n. Aqu铆 filtramos por valores *mayores o iguales* al l铆mite.
    # # La columna debe ser num茅rica para esta condici贸n.
    try:
        # # Convertir la columna de filtro a tipo num茅rico (float) para asegurar la comparaci贸n.
        df[columna_filtro] = pd.to_numeric(df[columna_filtro], errors='coerce')
        # # Crear la m谩scara booleana (True/False)
        condicion = df[columna_filtro] >= valor_limite
        
        # # Aplicar la m谩scara para obtener el DataFrame filtrado
        df_filtrado = df[condicion].copy() # Usamos .copy() para evitar SettingWithCopyWarning
        
        filas_filtradas = len(df_filtrado)
        
        print(f"# Se aplic贸 el filtro en la columna '{columna_filtro}': Valores >= {valor_limite}")
        print(f"# Filas originales: {len(df)} | Filas resultantes: {filas_filtradas}")
        
        if filas_filtradas == 0:
            print("# Advertencia: Ninguna fila cumpli贸 con la condici贸n de filtro.")
            return True
        
    except TypeError:
        print(f"Error: La columna '{columna_filtro}' no es de un tipo num茅rico v谩lido para esta condici贸n.")
        return False
    except Exception as e:
        print(f"Error durante la aplicaci贸n del filtro: {e}")
        return False

    # 4. Guardar el DataFrame filtrado en un nuevo archivo CSV
    nombre_archivo_salida = f"datos_filtrados_{columna_filtro}.csv"
    try:
        # # Guardar el DataFrame filtrado. `index=False` evita escribir el 铆ndice de Pandas.
        df_filtrado.to_csv(nombre_archivo_salida, index=False, encoding='utf-8')
        print(f"\n# xito: Los resultados se guardaron en '{nombre_archivo_salida}'")
        return True
        
    except Exception as e:
        print(f"Error al escribir el archivo de salida CSV: {e}")
        return False


# --- Bloque Principal de Ejecuci贸n ---

# # 1. Define las variables de configuraci贸n
ARCHIVO_ENTRADA = "ventas_mensuales.csv"
COLUMNA_A_FILTRAR = "MontoVenta"
UMBRAL_DE_FILTRO = 500.00

# # 2. Llama a la funci贸n principal
print("# --- INICIO DEL FILTRO DE DATOS ---")
exito = filtrar_datos_csv(ARCHIVO_ENTRADA, COLUMNA_A_FILTRAR, UMBRAL_DE_FILTRO)

# # 3. Muestra el resultado final
if exito:
    print("# Proceso de filtrado completado con 茅xito.")
else:
    print("# El proceso de filtrado fall贸.")
print("# ----------------------------------")

# ---

# # A continuaci贸n se muestra c贸mo deber铆a verse el archivo de entrada para el ejemplo:
# # ventas_mensuales.csv (Copia y pega esto en un archivo llamado 'ventas_mensuales.csv'):
# # ID,Producto,MontoVenta,Region
# # 1,Laptop,1200.50,Norte
# # 2,Mouse,15.99,Sur
# # 3,Teclado,85.00,Este
# # 4,Monitor,650.25,Oeste
# # 5,Webcam,45.99,Norte
# # 6,Impresora,450.00,Sur
# # 7,Servidor,2100.75,Este
# # 8,Auriculares,105.50,Oeste

# # Si se ejecuta con el ejemplo, el resultado de `datos_filtrados_MontoVenta.csv` solo contendr谩 las filas con MontoVenta >= 500.00.
```

##  Instrucciones para Usar el Programa

1.  **Instala Pandas:** Si no lo tienes, abre tu terminal y ejecuta:
    ```bash
    pip install pandas
    ```
2.  **Guarda el c贸digo:** Guarda el c贸digo Python anterior en un archivo, por ejemplo, `filtro_pandas.py`.
3.  **Crea el archivo CSV de entrada:** En la **misma carpeta**, crea un archivo llamado `ventas_mensuales.csv` y a帽ade los datos de ejemplo que est谩n al final del c贸digo (o tus propios datos, asegur谩ndote de que la columna `MontoVenta` exista).
4.  **Ejecuta el script:** Abre tu terminal y ejecuta:
    ```bash
    python filtro_pandas.py
    ```

# El script crear谩 un nuevo archivo llamado `datos_filtrados_MontoVenta.csv` con las filas que cumplan la condici贸n.

